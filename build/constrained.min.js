(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function(){!function(t){"use strict";var e="undefined"!=typeof t.HTMLElement,n=function(t){for(var e=null;t&&t!=Object.prototype;){if(t.tagName){e=t.tagName;break}t=t.prototype}return e||"div"},i=1e-8,r={},s=function(t,e){if(t&&e){if("function"==typeof t[e])return t[e];var n=t.prototype;if(n&&"function"==typeof n[e])return n[e];if(n!==Object.prototype&&n!==Function.prototype)return"function"==typeof t.__super__?s(t.__super__,e):void 0}},a=!1;try{var l=new Map;l.set("foo","bar");var o=l.values();o.next(),l.forEach(function(){});var u=new Map(l);if(u.get("foo")!=l.get("foo"))throw"ctor fail";a=!0}catch(h){}var c=t.c=function(){return c._api?c._api.apply(this,arguments):void 0};c._functionalMap=a,c.GEQ=1,c.LEQ=2;var f=e?function(e,i,r){if(i&&i.prototype instanceof t.HTMLElement){var s=e,a=n(r),l=function(t){return t.__proto__=r,s.apply(t,arguments),r.created&&t.created(),r.decorate&&t.decorate(),t};c.extend(r,{upgrade:l}),e=function(){return l(t.document.createElement(a))},e.prototype=r,c.extend(e,{ctor:s})}return e}:function(t){return t};c.inherit=function(t){var e=null,n=null;t["extends"]&&(n=t["extends"],delete t["extends"]),t.initialize&&(e=t.initialize,delete t.initialize);var i=e||function(){};Object.defineProperty(i,"__super__",{value:n?n:Object,enumerable:!1,configurable:!0,writable:!1}),t._t&&(r[t._t]=i);var s=i.prototype=Object.create(n?n.prototype:Object.prototype);return c.extend(s,t),f(i,n,s,t)},c.own=function(e,n,i){return Object.getOwnPropertyNames(e).forEach(n,i||t),e},c.extend=function(t,e){return c.own(e,function(n){var i=Object.getOwnPropertyDescriptor(e,n);if("function"==typeof i.get||"function"==typeof i.set)Object.defineProperty(t,n,i);else if("function"==typeof i.value||"_"===n.charAt(0))i.writable=!0,i.configurable=!0,i.enumerable=!1,Object.defineProperty(t,n,i);else try{t[n]=e[n]}catch(r){}}),t},c.assert=function(t,e){if(!t)throw new c.InternalError("Assertion failed: "+e)};var d=function(t){return"number"==typeof t?c.Expression.fromConstant(t):t instanceof c.Variable?c.Expression.fromVariable(t):t};c.plus=function(t,e){return t=d(t),e=d(e),t.plus(e)},c.minus=function(t,e){return t=d(t),e=d(e),t.minus(e)},c.times=function(t,e){return t=d(t),e=d(e),t.times(e)},c.divide=function(t,e){return t=d(t),e=d(e),t.divide(e)},c.approx=function(t,e){return t=+t,e=+e,t===e?!0:0==t?Math.abs(e)<i:0==e?Math.abs(t)<i:Math.abs(t-e)<Math.abs(t)*i};var p=1;c._inc=function(){return p++},c.parseJSON=function(t){return JSON.parse(t,function(t,e){if("object"!=typeof e||"string"!=typeof e._t)return e;var n=e._t,i=r[n];if(n&&i){var a=s(i,"fromJSON");if(a)return a(e,i)}return e})},"function"==typeof define&&define.amd?define(c):"object"==typeof module&&module.exports?module.exports=c:t.c=c}(this),function(t){"use strict";if(t._functionalMap)t.HashTable=t.inherit({initialize:function(e){this.hashCode=t._inc(),this._store=e instanceof t.HashTable?new Map(e._store):new Map},clone:function(){return new t.HashTable(this)},get:function(t){var e=this._store.get(t.hashCode);return void 0===e?null:e[1]},clear:function(){this._store.clear()},get size(){return this._store.size},set:function(t,e){return this._store.set(t.hashCode,[t,e])},has:function(t){return this._store.has(t.hashCode)},"delete":function(t){return this._store["delete"](t.hashCode)},each:function(t,e){this._store.forEach(function(n){return t.call(e||null,n[0],n[1])},e)},escapingEach:function(t,e){if(this._store.size)for(var n,i,r=this._store.values(),i=r.next();!i.done;){if(n=t.call(e||null,i.value[0],i.value[1])){if(void 0!==n.retval)return n;if(n.brk)break}i=r.next()}},equals:function(e){if(e===this)return!0;if(!(e instanceof t.HashTable)||e._size!==this._size)return!1;for(var n in this._store.keys())if(void 0==e._store.get(n))return!1;return!0}});else{var e={},n=function(t,e){Object.keys(t).forEach(function(n){e[n]=t[n]})};t.HashTable=t.inherit({initialize:function(){this.size=0,this._store={},this._deleted=0},set:function(t,e){var n=t.hashCode;"undefined"==typeof this._store[n]&&this.size++,this._store[n]=[t,e]},get:function(t){if(!this.size)return null;t=t.hashCode;var e=this._store[t];return"undefined"!=typeof e?e[1]:null},clear:function(){this.size=0,this._store={}},_compact:function(){var t={};n(this._store,t),this._store=t},_compactThreshold:100,_perhapsCompact:function(){this._size>30||this._deleted>this._compactThreshold&&(this._compact(),this._deleted=0)},"delete":function(t){t=t.hashCode,this._store.hasOwnProperty(t)&&(this._deleted++,delete this._store[t],this.size>0&&this.size--)},each:function(t,e){if(this.size){this._perhapsCompact();var n=this._store;for(var i in this._store)this._store.hasOwnProperty(i)&&t.call(e||null,n[i][0],n[i][1])}},escapingEach:function(t,n){if(this.size){this._perhapsCompact();for(var i=this,r=this._store,s=e,a=Object.keys(r),l=0;l<a.length;l++)if(function(e){i._store.hasOwnProperty(e)&&(s=t.call(n||null,r[e][0],r[e][1]))}(a[l]),s){if(void 0!==s.retval)return s;if(s.brk)break}}},clone:function(){var e=new t.HashTable;return this.size&&(e.size=this.size,n(this._store,e._store)),e},equals:function(e){if(e===this)return!0;if(!(e instanceof t.HashTable)||e._size!==this._size)return!1;for(var n=Object.keys(this._store),i=0;i<n.length;i++){var r=n[i];if(this._store[r][0]!==e._store[r][0])return!1}return!0},toString:function(){var t="";return this.each(function(e,n){t+=e+" => "+n+"\n"}),t},toJSON:function(){return{_t:"c.HashTable"}},fromJSON:function(){var e=new t.HashTable;return e}})}}(this.c||module.parent.exports||{}),function(t){"use strict";t.HashSet=t._functionalMap?t.inherit({_t:"c.HashSet",initialize:function(e){this.hashCode=t._inc(),this._store=e instanceof t.HashSet?new Map(e._store):new Map},add:function(t){return this._store.set(t.hashCode,t)},has:function(t){return this._store.has(t.hashCode)},get size(){return this._store.size},clear:function(){this._store.clear()},values:function(){for(var t=[],e=this._store.values(),n=e.next();!n.done;)t.push(n.value),n=e.next();return t},first:function(){var t=this._store.values(),e=t.next();return e.done?null:e.value},"delete":function(t){this._store["delete"](t.hashCode)},each:function(t,e){var n=this;this._store.forEach(function(i){return t.call(e||null,i,i,n)},e)},escapingEach:function(t,e){this.size&&this._store.forEach(t,e)},toString:function(){var t=this.size+" {",e=!0;return this.each(function(n){e?e=!1:t+=", ",t+=n}),t+="}\n"},toJSON:function(){var t=[];return this.each(function(e){t[t.length]=e.toJSON()}),{_t:"c.HashSet",data:t}},fromJSON:function(e){var n=new t.HashSet;return e.data&&(n.size=e.data.length,n._store=e.data),n}}):t.inherit({_t:"c.HashSet",initialize:function(){this._store=[],this.size=0,this.hashCode=t._inc()},add:function(t){var e=this._store;e.indexOf(t),-1==e.indexOf(t)&&(e[e.length]=t),this.size=e.length},values:function(){return this._store},first:function(){return this._store[0]},has:function(t){return-1!=this._store.indexOf(t)},"delete":function(t){var e=this._store.indexOf(t);return-1==e?null:(this._store.splice(e,1)[0],void(this.size=this._store.length))},clear:function(){this._store.length=0},each:function(t,e){this.size&&this._store.forEach(t,e)},escapingEach:function(t,e){this.size&&this._store.forEach(t,e)},toString:function(){var t=this.size+" {",e=!0;return this.each(function(n){e?e=!1:t+=", ",t+=n}),t+="}\n"},toJSON:function(){var t=[];return this.each(function(e){t[t.length]=e.toJSON()}),{_t:"c.HashSet",data:t}},fromJSON:function(e){var n=new t.HashSet;return e.data&&(n.size=e.data.length,n._store=e.data),n}})}(this.c||module.parent.exports||{}),function(t){"use strict";t.Error=t.inherit({initialize:function(t){t&&(this._description=t)},_name:"c.Error",_description:"An error has occured in Cassowary",set description(t){this._description=t},get description(){return"("+this._name+") "+this._description},get message(){return this.description},toString:function(){return this.description}});var e=function(e,n){return t.inherit({"extends":t.Error,initialize:function(){t.Error.apply(this,arguments)},_name:e||"",_description:n||""})};t.ConstraintNotFound=e("c.ConstraintNotFound","Tried to remove a constraint never added to the tableu"),t.InternalError=e("c.InternalError"),t.NonExpression=e("c.NonExpression","The resulting expression would be non"),t.NotEnoughStays=e("c.NotEnoughStays","There are not enough stays to give specific values to every variable"),t.RequiredFailure=e("c.RequiredFailure","A required constraint cannot be satisfied"),t.TooDifficult=e("c.TooDifficult","The constraints are too difficult to solve")}(this.c||module.parent.exports||{}),function(t){"use strict";var e=1e3;t.SymbolicWeight=t.inherit({_t:"c.SymbolicWeight",initialize:function(){this.value=0;for(var t=1,n=arguments.length-1;n>=0;--n)this.value+=arguments[n]*t,t*=e},toJSON:function(){return{_t:this._t,value:this.value}}})}(this.c||module.parent.exports||{}),function(t){t.Strength=t.inherit({initialize:function(e,n,i,r){this.name=e,this.symbolicWeight=n instanceof t.SymbolicWeight?n:new t.SymbolicWeight(n,i,r)},get required(){return this===t.Strength.required},toString:function(){return this.name+(this.required?"":":"+this.symbolicWeight)}}),t.Strength.required=new t.Strength("<Required>",1e3,1e3,1e3),t.Strength.strong=new t.Strength("strong",1,0,0),t.Strength.medium=new t.Strength("medium",0,1,0),t.Strength.weak=new t.Strength("weak",0,0,1)}(this.c||("undefined"!=typeof module?module.parent.exports.c:{})),function(t){"use strict";t.AbstractVariable=t.inherit({isDummy:!1,isExternal:!1,isPivotable:!1,isRestricted:!1,_init:function(e,n){this.hashCode=t._inc(),this.name=(n||"")+this.hashCode,e&&("undefined"!=typeof e.name&&(this.name=e.name),"undefined"!=typeof e.value&&(this.value=e.value),"undefined"!=typeof e.prefix&&(this._prefix=e.prefix))},_prefix:"",name:"",value:0,valueOf:function(){return this.value},toJSON:function(){var t={};return this._t&&(t._t=this._t),this.name&&(t.name=this.name),"undefined"!=typeof this.value&&(t.value=this.value),this._prefix&&(t._prefix=this._prefix),this._t&&(t._t=this._t),t},fromJSON:function(e,n){var i=new n;return t.extend(i,e),i},toString:function(){return this._prefix+"["+this.name+":"+this.value+"]"}}),t.Variable=t.inherit({_t:"c.Variable","extends":t.AbstractVariable,initialize:function(e){this._init(e,"v");var n=t.Variable._map;n&&(n[this.name]=this)},isExternal:!0}),t.DummyVariable=t.inherit({_t:"c.DummyVariable","extends":t.AbstractVariable,initialize:function(t){this._init(t,"d")},isDummy:!0,isRestricted:!0,value:"dummy"}),t.ObjectiveVariable=t.inherit({_t:"c.ObjectiveVariable","extends":t.AbstractVariable,initialize:function(t){this._init(t,"o")},value:"obj"}),t.SlackVariable=t.inherit({_t:"c.SlackVariable","extends":t.AbstractVariable,initialize:function(t){this._init(t,"s")},isPivotable:!0,isRestricted:!0,value:"slack"})}(this.c||module.parent.exports||{}),function(t){"use strict";t.Point=t.inherit({initialize:function(e,n,i){if(e instanceof t.Variable)this._x=e;else{var r={value:e};i&&(r.name="x"+i),this._x=new t.Variable(r)}if(n instanceof t.Variable)this._y=n;else{var s={value:n};i&&(s.name="y"+i),this._y=new t.Variable(s)}},get x(){return this._x},set x(e){e instanceof t.Variable?this._x=e:this._x.value=e},get y(){return this._y},set y(e){e instanceof t.Variable?this._y=e:this._y.value=e},toString:function(){return"("+this.x+", "+this.y+")"}})}(this.c||module.parent.exports||{}),function(t){"use strict";var e=function(t,e){return"number"==typeof t?t:e};t.Expression=t.inherit({initialize:function(n,i,r){this.constant=e(r,0),this.terms=new t.HashTable,this.externalVariables=new t.HashSet,Object.defineProperty(this,"solver",{enumerable:!1,configurable:!0,writable:!0,value:null}),n instanceof t.AbstractVariable?(i=e(i,1),this.setVariable(n,i)):"number"==typeof n&&(isNaN(n)?console.trace():this.constant=n)},initializeFromHash:function(t,e){return this.constant=t,this.terms=e.clone(),this},multiplyMe:function(t){this.constant*=t;var e=this.terms;return e.each(function(n,i){e.set(n,i*t)}),this},clone:function(){var e=t.Expression.empty();return e.initializeFromHash(this.constant,this.terms),e.solver=this.solver,e},times:function(e){if("number"==typeof e)return this.clone().multiplyMe(e);if(this.isConstant)return e.times(this.constant);if(e.isConstant)return this.times(e.constant);throw new t.NonExpression},plus:function(e){return e instanceof t.Expression?this.clone().addExpression(e,1):e instanceof t.Variable?this.clone().addVariable(e,1):void 0},minus:function(e){return e instanceof t.Expression?this.clone().addExpression(e,-1):e instanceof t.Variable?this.clone().addVariable(e,-1):void 0},divide:function(e){if("number"==typeof e){if(t.approx(e,0))throw new t.NonExpression;return this.times(1/e)}if(e instanceof t.Expression){if(!e.isConstant)throw new t.NonExpression;return this.times(1/e.constant)}},addExpression:function(n,i,r){return n instanceof t.AbstractVariable&&(n=t.Expression.fromVariable(n)),i=e(i,1),this.constant+=i*n.constant,n.terms.each(function(t,e){this.addVariable(t,e*i,r),this._updateIfExternal(t)},this),this},addVariable:function(e,n,i){null==n&&(n=1);var r=this.terms.get(e);if(r){var s=r+n;0==s||t.approx(s,0)?(this.solver&&this.solver.noteRemovedVariable(e,i),this.terms["delete"](e)):this.setVariable(e,s)}else t.approx(n,0)||(this.setVariable(e,n),this.solver&&this.solver.noteAddedVariable(e,i));return this},_updateIfExternal:function(t){t.isExternal&&(this.externalVariables.add(t),this.solver&&this.solver._noteUpdatedExternal(t))},setVariable:function(t,e){return this.terms.set(t,e),this._updateIfExternal(t),this},anyPivotableVariable:function(){if(this.isConstant)throw new t.InternalError("anyPivotableVariable called on a constant");var e=this.terms.escapingEach(function(t){return t.isPivotable?{retval:t}:void 0});return e&&void 0!==e.retval?e.retval:null},substituteOut:function(e,n,i){var r=this.solver;if(!r)throw new t.InternalError("Expressions::substituteOut called without a solver");var s=this.setVariable.bind(this),a=this.terms,l=a.get(e);a["delete"](e),this.constant+=l*n.constant,n.terms.each(function(e,n){var o=a.get(e);if(o){var u=o+l*n;t.approx(u,0)?(r.noteRemovedVariable(e,i),a["delete"](e)):s(e,u)}else s(e,l*n),r&&r.noteAddedVariable(e,i)})},changeSubject:function(t,e){this.setVariable(t,this.newSubject(e))},newSubject:function(t){var e=1/this.terms.get(t);return this.terms["delete"](t),this.multiplyMe(-e),e},coefficientFor:function(t){return this.terms.get(t)||0},get isConstant(){return 0==this.terms.size},toString:function(){var e="",n=!1;if(!t.approx(this.constant,0)||this.isConstant){if(e+=this.constant,this.isConstant)return e;n=!0}return this.terms.each(function(t,i){n&&(e+=" + "),e+=i+"*"+t,n=!0}),e},equals:function(e){return e===this?!0:e instanceof t.Expression&&e.constant===this.constant&&e.terms.equals(this.terms)},Plus:function(t,e){return t.plus(e)},Minus:function(t,e){return t.minus(e)},Times:function(t,e){return t.times(e)},Divide:function(t,e){return t.divide(e)}}),t.Expression.empty=function(e){var n=new t.Expression(void 0,1,0);return n.solver=e,n},t.Expression.fromConstant=function(e,n){var i=new t.Expression(e);return i.solver=n,i},t.Expression.fromValue=function(e,n){e=+e;var i=new t.Expression(void 0,e,0);return i.solver=n,i},t.Expression.fromVariable=function(e,n){var i=new t.Expression(e,1,0);return i.solver=n,i}}(this.c||module.parent.exports||{}),function(t){"use strict";t.AbstractConstraint=t.inherit({initialize:function(e,n){this.hashCode=t._inc(),this.strength=e||t.Strength.required,this.weight=n||1},isEdit:!1,isInequality:!1,isStay:!1,get required(){return this.strength===t.Strength.required},toString:function(){return this.strength+" {"+this.weight+"} ("+this.expression+")"}});var e=t.AbstractConstraint.prototype.toString,n=function(e,n,i){t.AbstractConstraint.call(this,n||t.Strength.strong,i),this.variable=e,this.expression=new t.Expression(e,-1,e.value)};t.EditConstraint=t.inherit({"extends":t.AbstractConstraint,initialize:function(){n.apply(this,arguments)},isEdit:!0,toString:function(){return"edit:"+e.call(this)}}),t.StayConstraint=t.inherit({"extends":t.AbstractConstraint,initialize:function(){n.apply(this,arguments)},isStay:!0,toString:function(){return"stay:"+e.call(this)}});var i=t.Constraint=t.inherit({"extends":t.AbstractConstraint,initialize:function(e,n,i){t.AbstractConstraint.call(this,n,i),this.expression=e}});t.Inequality=t.inherit({"extends":t.Constraint,_cloneOrNewCle:function(e){return e.clone?e.clone():new t.Expression(e)},initialize:function(e,n,r,s,a){var l=e instanceof t.Expression,o=r instanceof t.Expression,u=e instanceof t.AbstractVariable,h=r instanceof t.AbstractVariable,c="number"==typeof e,f="number"==typeof r;if((l||c)&&h){var d=e,p=n,v=r,b=s,_=a;if(i.call(this,this._cloneOrNewCle(d),b,_),p==t.LEQ)this.expression.multiplyMe(-1),this.expression.addVariable(v);else{if(p!=t.GEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(v,-1)}}else if(u&&(o||f)){var d=r,p=n,v=e,b=s,_=a;if(i.call(this,this._cloneOrNewCle(d),b,_),p==t.GEQ)this.expression.multiplyMe(-1),this.expression.addVariable(v);else{if(p!=t.LEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(v,-1)}}else{if(l&&f){var m=e,p=n,g=r,b=s,_=a;if(i.call(this,this._cloneOrNewCle(m),b,_),p==t.LEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(g));else{if(p!=t.GEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(g),-1)}return this}if(c&&o){var m=r,p=n,g=e,b=s,_=a;if(i.call(this,this._cloneOrNewCle(m),b,_),p==t.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(g));else{if(p!=t.LEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(g),-1)}return this}if(l&&o){var m=e,p=n,g=r,b=s,_=a;if(i.call(this,this._cloneOrNewCle(g),b,_),p==t.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(m));else{if(p!=t.LEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(m),-1)}}else{if(l)return i.call(this,e,n,r);if(n==t.GEQ)i.call(this,new t.Expression(r),s,a),this.expression.multiplyMe(-1),this.expression.addVariable(e);else{if(n!=t.LEQ)throw new t.InternalError("Invalid operator in c.Inequality constructor");i.call(this,new t.Expression(r),s,a),this.expression.addVariable(e,-1)}}}},isInequality:!0,toString:function(){return i.prototype.toString.call(this)+" >= 0) id: "+this.hashCode}}),t.Equation=t.inherit({"extends":t.Constraint,initialize:function(e,n,r,s){if(e instanceof t.Expression&&!n||n instanceof t.Strength)i.call(this,e,n,r);else if(e instanceof t.AbstractVariable&&n instanceof t.Expression){var a=e,l=n,o=r,u=s;i.call(this,l.clone(),o,u),this.expression.addVariable(a,-1)}else if(e instanceof t.AbstractVariable&&"number"==typeof n){var a=e,h=n,o=r,u=s;i.call(this,new t.Expression(h),o,u),this.expression.addVariable(a,-1)}else if(e instanceof t.Expression&&n instanceof t.AbstractVariable){var l=e,a=n,o=r,u=s;i.call(this,l.clone(),o,u),this.expression.addVariable(a,-1)}else{if(!(e instanceof t.Expression||e instanceof t.AbstractVariable||"number"==typeof e)||!(n instanceof t.Expression||n instanceof t.AbstractVariable||"number"==typeof n))throw"Bad initializer to c.Equation";e=e instanceof t.Expression?e.clone():new t.Expression(e),n=n instanceof t.Expression?n.clone():new t.Expression(n),i.call(this,e,r,s),this.expression.addExpression(n,-1)}t.assert(this.strength instanceof t.Strength,"_strength not set")},toString:function(){return i.prototype.toString.call(this)+" = 0)"}})}(this.c||module.parent.exports||{}),function(t){"use strict";t.EditInfo=t.inherit({initialize:function(t,e,n,i,r){this.constraint=t,this.editPlus=e,this.editMinus=n,this.prevEditConstant=i,this.index=r},toString:function(){return"<cn="+this.constraint+", ep="+this.editPlus+", em="+this.editMinus+", pec="+this.prevEditConstant+", index="+this.index+">"}})}(this.c||module.parent.exports||{}),function(t){"use strict";t.Tableau=t.inherit({initialize:function(){this.columns=new t.HashTable,this.rows=new t.HashTable,this._infeasibleRows=new t.HashSet,this._externalRows=new t.HashTable},noteRemovedVariable:function(t,e){var n=this.columns.get(t);e&&n&&n["delete"](e)},noteAddedVariable:function(t,e){e&&this.insertColVar(t,e)},getInternalInfo:function(){return"Tableau Information:\nRows: "+this.rows.size+" (= "+(this.rows.size-1)+" constraints)\nColumns: "+this.columns.size+"\nInfeasible Rows: "+this._infeasibleRows.size+"\nExternal basic variables: "+this._externalRows.size},toString:function(){var t="Tableau:\n";return this.rows.each(function(e,n){t+=e+" <==> "+n+"\n"}),t+="\nColumns:\n",this.columns.each(function(e,n){t+=e+" <==> "+n}),t+="\nInfeasible rows: ",t+=this._infeasibleRows,t+="External basic variables: ",t+=this._externalRows},insertColVar:function(e,n){var i=this.columns.get(e);i||(i=new t.HashSet,this.columns.set(e,i)),i.add(n)},addRow:function(t,e){this.rows.set(t,e),e.terms.each(function(e){this.insertColVar(e,t)},this),t.isExternal&&this._externalRows.set(t,e)},removeColumn:function(t){var e=this.columns.get(t);e&&(this.columns["delete"](t),e.each(function(e){var n=this.rows.get(e);n.terms["delete"](t)},this)),t.isExternal&&this._externalRows["delete"](t)},removeRow:function(e){var n=this.rows.get(e);return t.assert(null!=n),n.terms.each(function(t){var n=this.columns.get(t);null!=n&&n["delete"](e)},this),this._infeasibleRows["delete"](e),e.isExternal&&this._externalRows["delete"](e),this.rows["delete"](e),n},substituteOut:function(t,e){var n=this.columns.get(t);n.each(function(n){var i=this.rows.get(n);i.substituteOut(t,e,n,this),n.isExternal&&this._updatedExternals.add(n),n.isRestricted&&i.constant<0&&this._infeasibleRows.add(n)},this),t.isExternal&&this._externalRows.set(t,e),this.columns["delete"](t)},columnsHasKey:function(t){return!!this.columns.get(t)}})}(this.c||module.parent.exports||{}),function(t){var e=t.Tableau,n=e.prototype,i=1e-8,r=t.Strength.weak,s={eplus:null,eminus:null,prevEConstant:null};t.SimplexSolver=t.inherit({"extends":t.Tableau,initialize:function(){t.Tableau.call(this),this._stayMinusErrorVars=[],this._stayPlusErrorVars=[],this._errorVars=new t.HashTable,this._markerVars=new t.HashTable,this._objective=new t.ObjectiveVariable({name:"Z"}),this._editVarMap=new t.HashTable,this._editVarList=[],this._slackCounter=0,this._artificialCounter=0,this._dummyCounter=0,this.autoSolve=!0,this._needsSolving=!1,this._optimizeCount=0,this.rows.set(this._objective,t.Expression.empty(this)),this._editVariableStack=[0],this._updatedExternals=new t.HashSet},_noteUpdatedExternal:function(t){this._updatedExternals.add(t)},add:function(){for(var t=0;t<arguments.length;t++)this.addConstraint(arguments[t]);return this},addEditVar:function(e,n,i){var r=new t.EditConstraint(e,n||t.Strength.strong,i);return this.addEditConstraint(r),this},addEditConstraint:function(t){var e=s;return this.addConstraint(t),this._addEditConstraint(t,e.eplus,e.eminus,e.prevEConstant),this},_addEditConstraint:function(e,n,i,r){var s=this._editVarMap.size,a=new t.EditInfo(e,n,i,r,s);this._editVarMap.set(e.variable,a),this._editVarList[s]={v:e.variable,info:a}},addConstraint:function(e){if(e instanceof t.Constraint){var n=this;e.expression.externalVariables.each(function(t){n._noteUpdatedExternal(t)})}var i=this.newExpression(e);return i.solver=this,this.tryAddingDirectly(i)||this.addWithArtificialVariable(i),this._needsSolving=!0,this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},addConstraintNoException:function(t){try{return this.addConstraint(t),!0}catch(e){return console.error(e),!1}},beginEdit:function(){return t.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this._infeasibleRows.clear(),this._resetStayConstants(),this._editVariableStack[this._editVariableStack.length]=this._editVarMap.size,this},endEdit:function(){return t.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this.resolve(),this._editVariableStack.pop(),this.removeEditVarsTo(this._editVariableStack[this._editVariableStack.length-1]),this},removeAllEditVars:function(){return this.removeEditVarsTo(0)},removeEditVarsTo:function(e){try{for(var n=this._editVarList.length,i=e;n>i;i++)this._editVarList[i]&&this.removeConstraint(this._editVarMap.get(this._editVarList[i].v).constraint);return this._editVarList.length=e,t.assert(this._editVarMap.size==e,"_editVarMap.size == n"),this}catch(r){throw new t.InternalError("Constraint not found in removeEditVarsTo")}},addPointStays:function(t){return t.forEach(function(t,e){this.addStay(t.x,r,Math.pow(2,e)),this.addStay(t.y,r,Math.pow(2,e))},this),this},addStay:function(e,n,i){var s=new t.StayConstraint(e,n||r,i||1);return this.addConstraint(s)},setConstant:function(t,e){this._setConstant(t,e),this.resolve()},removeConstraint:function(e){this._needsSolving=!0,this._resetStayConstants();var n=this.rows.get(this._objective),i=this._errorVars.get(e);null!=i&&i.each(function(t){var i=this.rows.get(t);null==i?n.addVariable(t,-e.weight*e.strength.symbolicWeight.value,this._objective,this):n.addExpression(i,-e.weight*e.strength.symbolicWeight.value,this._objective,this)},this);var r=this._markerVars.get(e);if(this._markerVars["delete"](e),null==r)throw new t.InternalError("Constraint not found in removeConstraintInternal");if(null==this.rows.get(r)){var s=this.columns.get(r),a=null,l=0;s.each(function(e){if(e.isRestricted){var n=this.rows.get(e),i=n.coefficientFor(r);if(0>i){var s=-n.constant/i;(null==a||l>s||t.approx(s,l)&&e.hashCode<a.hashCode)&&(l=s,a=e)}}},this),null==a&&s.each(function(t){if(t.isRestricted){var e=this.rows.get(t),n=e.coefficientFor(r),i=e.constant/n;(null==a||l>i)&&(l=i,a=t)}},this),null==a&&(0==s.size?this.removeColumn(r):s.escapingEach(function(t){return t!=this._objective?(a=t,{brk:!0}):void 0},this)),null!=a&&this.pivot(r,a)}if(null!=this.rows.get(r)&&this.removeRow(r),null!=i&&i.each(function(t){t!=r&&this.removeColumn(t)},this),e.isStay){if(null!=i)for(var o=0;o<this._stayPlusErrorVars.length;o++)i["delete"](this._stayPlusErrorVars[o]),i["delete"](this._stayMinusErrorVars[o])}else if(e.isEdit){var u=this._editVarMap.get(e.variable);this.removeColumn(u.editMinus),this._editVarMap["delete"](e.variable)}return null!=i&&this._errorVars["delete"](i),this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},reset:function(){throw new t.InternalError("reset not implemented")},resolveArray:function(t){var e=t.length;this._editVarMap.each(function(n,i){var r=i.index;e>r&&this.suggestValue(n,t[r])},this),this.resolve()},resolvePair:function(t,e){this.suggestValue(this._editVarList[0].v,t),this.suggestValue(this._editVarList[1].v,e),this.resolve()},resolve:function(){this.dualOptimize(),this._setExternalVariables(),this._infeasibleRows.clear(),this._resetStayConstants()},suggestValue:function(e,n){var i=this._editVarMap.get(e);if(!i)throw new t.Error("suggestValue for variable "+e+", but var is not an edit variable");var r=n-i.prevEditConstant;return i.prevEditConstant=n,this.deltaEditConstant(r,i.editPlus,i.editMinus),this},solve:function(){return this._needsSolving&&(this.optimize(this._objective),this._setExternalVariables()),this},setEditedValue:function(e,n){if(!this.columnsHasKey(e)&&null==this.rows.get(e))return e.value=n,this;if(!t.approx(n,e.value)){this.addEditVar(e),this.beginEdit();try{this.suggestValue(e,n)}catch(i){throw new t.InternalError("Error in setEditedValue")}this.endEdit()}return this},addVar:function(e){if(!this.columnsHasKey(e)&&null==this.rows.get(e))try{this.addStay(e)}catch(n){throw new t.InternalError("Error in addVar -- required failure is impossible")}return this},getInternalInfo:function(){var t=n.getInternalInfo.call(this);return t+="\nSolver info:\n",t+="Stay Error Variables: ",t+=this._stayPlusErrorVars.length+this._stayMinusErrorVars.length,t+=" ("+this._stayPlusErrorVars.length+" +, ",t+=this._stayMinusErrorVars.length+" -)\n",t+="Edit Variables: "+this._editVarMap.size,t+="\n"},getDebugInfo:function(){return this.toString()+this.getInternalInfo()+"\n"},toString:function(){var t=n.getInternalInfo.call(this);return t+="\n_stayPlusErrorVars: ",t+="["+this._stayPlusErrorVars+"]",t+="\n_stayMinusErrorVars: ",t+="["+this._stayMinusErrorVars+"]",t+="\n",t+="_editVarMap:\n"+this._editVarMap,t+="\n"},addWithArtificialVariable:function(e){var n=new t.SlackVariable({value:++this._artificialCounter,prefix:"a"}),i=new t.ObjectiveVariable({name:"az"}),r=e.clone();this.addRow(i,r),this.addRow(n,e),this.optimize(i);var s=this.rows.get(i);if(!t.approx(s.constant,0))throw this.removeRow(i),this.removeColumn(n),new t.RequiredFailure;var a=this.rows.get(n);if(null!=a){if(a.isConstant)return this.removeRow(n),void this.removeRow(i);var l=a.anyPivotableVariable();this.pivot(l,n)}t.assert(null==this.rows.get(n),"rowExpression(av) == null"),this.removeColumn(n),this.removeRow(i)},tryAddingDirectly:function(t){var e=this.chooseSubject(t);return null==e?!1:(t.newSubject(e),this.columnsHasKey(e)&&this.substituteOut(e,t),this.addRow(e,t),!0)},chooseSubject:function(e){var n=null,i=!1,r=!1,s=e.terms,a=s.escapingEach(function(t,e){if(i){if(!t.isRestricted&&!this.columnsHasKey(t))return{retval:t}}else if(t.isRestricted){if(!r&&!t.isDummy&&0>e){var s=this.columns.get(t);(null==s||1==s.size&&this.columnsHasKey(this._objective))&&(n=t,r=!0)}}else n=t,i=!0},this);if(a&&void 0!==a.retval)return a.retval;if(null!=n)return n;var l=0,a=s.escapingEach(function(t,e){return t.isDummy?void(this.columnsHasKey(t)||(n=t,l=e)):{retval:null}},this);if(a&&void 0!==a.retval)return a.retval;if(!t.approx(e.constant,0))throw new t.RequiredFailure;return l>0&&e.multiplyMe(-1),n},deltaEditConstant:function(t,e,n){var i=this.rows.get(e);if(null!=i)return i.constant+=t,void(i.constant<0&&this._infeasibleRows.add(e));var r=this.rows.get(n);if(null!=r)return r.constant+=-t,void(r.constant<0&&this._infeasibleRows.add(n));var s=this.columns.get(n);s||console.log("columnVars is null -- tableau is:\n"+this),s.each(function(e){var i=this.rows.get(e),r=i.coefficientFor(n);i.constant+=r*t,e.isExternal&&this._noteUpdatedExternal(e),e.isRestricted&&i.constant<0&&this._infeasibleRows.add(e)},this)},dualOptimize:function(){for(var e=this.rows.get(this._objective);this._infeasibleRows.size;){var n=this._infeasibleRows.first();this._infeasibleRows["delete"](n);var i=null,r=this.rows.get(n);if(r&&r.constant<0){var s,a=Number.MAX_VALUE,l=r.terms;if(l.each(function(n,r){if(r>0&&n.isPivotable){var l=e.coefficientFor(n);s=l/r,(a>s||t.approx(s,a)&&n.hashCode<i.hashCode)&&(i=n,a=s)}}),a==Number.MAX_VALUE)throw new t.InternalError("ratio == nil (MAX_VALUE) in dualOptimize");this.pivot(i,n)}}},newExpression:function(e){var n=s;n.eplus=null,n.eminus=null,n.prevEConstant=null;var i=e.expression,r=t.Expression.fromConstant(i.constant,this),a=new t.SlackVariable,l=new t.DummyVariable,o=new t.SlackVariable,u=new t.SlackVariable,h=i.terms;if(h.each(function(t,e){var n=this.rows.get(t);n?r.addExpression(n,e):r.addVariable(t,e)},this),e.isInequality){if(++this._slackCounter,a=new t.SlackVariable({value:this._slackCounter,prefix:"s"}),r.setVariable(a,-1),this._markerVars.set(e,a),!e.required){++this._slackCounter,o=new t.SlackVariable({value:this._slackCounter,prefix:"em"}),r.setVariable(o,1);var c=this.rows.get(this._objective);c.setVariable(o,e.strength.symbolicWeight.value*e.weight),this.insertErrorVar(e,o),this.noteAddedVariable(o,this._objective)}}else if(e.required)++this._dummyCounter,l=new t.DummyVariable({value:this._dummyCounter,prefix:"d"}),n.eplus=l,n.eminus=l,n.prevEConstant=i.constant,r.setVariable(l,1),this._markerVars.set(e,l);else{++this._slackCounter,u=new t.SlackVariable({value:this._slackCounter,prefix:"ep"}),o=new t.SlackVariable({
value:this._slackCounter,prefix:"em"}),r.setVariable(u,-1),r.setVariable(o,1),this._markerVars.set(e,u);var c=this.rows.get(this._objective),f=e.strength.symbolicWeight.value*e.weight;c.setVariable(u,f),this.noteAddedVariable(u,this._objective),c.setVariable(o,f),this.noteAddedVariable(o,this._objective),this.insertErrorVar(e,o),this.insertErrorVar(e,u),e.isStay?(this._stayPlusErrorVars[this._stayPlusErrorVars.length]=u,this._stayMinusErrorVars[this._stayMinusErrorVars.length]=o):e.isEdit&&(n.eplus=u,n.eminus=o,n.prevEConstant=i.constant)}return r.constant<0&&r.multiplyMe(-1),r},optimize:function(e){this._optimizeCount++;var n=this.rows.get(e);t.assert(null!=n,"zRow != null");for(var r,s,a=null,l=null;;){if(r=0,s=n.terms,s.escapingEach(function(t,e){return t.isPivotable&&r>e?(r=e,a=t,{brk:1}):void 0},this),r>=-i)return;var o=Number.MAX_VALUE,u=this.columns.get(a),h=0;if(u.each(function(e){if(e.isPivotable){var n=this.rows.get(e),i=n.coefficientFor(a);0>i&&(h=-n.constant/i,(o>h||t.approx(h,o)&&e.hashCode<l.hashCode)&&(o=h,l=e))}},this),o==Number.MAX_VALUE)throw new t.InternalError("Objective function is unbounded in optimize");this.pivot(a,l)}},pivot:function(t,e){var n=!1;n&&console.time(" SimplexSolver::pivot"),null==t&&console.warn("pivot: entryVar == null"),null==e&&console.warn("pivot: exitVar == null"),n&&console.time("  removeRow");var i=this.removeRow(e);n&&console.timeEnd("  removeRow"),n&&console.time("  changeSubject"),i.changeSubject(e,t),n&&console.timeEnd("  changeSubject"),n&&console.time("  substituteOut"),this.substituteOut(t,i),n&&console.timeEnd("  substituteOut"),n&&console.time("  addRow"),this.addRow(t,i),n&&console.timeEnd("  addRow"),n&&console.timeEnd(" SimplexSolver::pivot")},_resetStayConstants:function(){for(var t=this._stayPlusErrorVars,e=t.length,n=0;e>n;n++){var i=this.rows.get(t[n]);null===i&&(i=this.rows.get(this._stayMinusErrorVars[n])),null!=i&&(i.constant=0)}},_setExternalVariables:function(){var t=[];this._updatedExternals.each(function(e){var n=e.value,i=this._externalRows.get(e);return i?(e.value=i.constant,void(n!==e.value&&t.push({type:"update",name:e.name,variable:e,oldValue:n}))):void(e.value=0)},this),this._updatedExternals.clear(),this._needsSolving=!1,this._informCallbacks(t),t.length&&this.onsolved(t)},onsolved:function(){},_informCallbacks:function(t){this._callbacks&&this._callbacks.forEach(function(e){e(t)})},_addCallback:function(t){var e=this._callbacks||(this._callbacks=[]);e[e.length]=t},insertErrorVar:function(e,n){var i=this._errorVars.get(e);i||(i=new t.HashSet,this._errorVars.set(e,i)),i.add(n)}})}(this.c||module.parent.exports||{}),function(t){"use strict";t.Timer=t.inherit({initialize:function(){this.isRunning=!1,this._elapsedMs=0},start:function(){return this.isRunning=!0,this._startReading=new Date,this},stop:function(){return this.isRunning=!1,this._elapsedMs+=new Date-this._startReading,this},reset:function(){return this.isRunning=!1,this._elapsedMs=0,this},elapsedTime:function(){return this.isRunning?(this._elapsedMs+(new Date-this._startReading))/1e3:this._elapsedMs/1e3}})}(this.c||module.parent.exports||{}),this.c.parser=function(){function t(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var e={parse:function(e,n){function i(t){F>P||(P>F&&(F=P,D=[]),D.push(t))}function r(){var t,e,n,i,r;if(i=P,r=P,t=g(),null!==t){for(e=[],n=s();null!==n;)e.push(n),n=s();null!==e?(n=g(),null!==n?t=[t,e,n]:(t=null,P=r)):(t=null,P=r)}else t=null,P=r;return null!==t&&(t=function(t,e){return e}(i,t[1])),null===t&&(P=i),t}function s(){var t,e,n,i;return n=P,i=P,t=N(),null!==t?(e=f(),null!==e?t=[t,e]:(t=null,P=i)):(t=null,P=i),null!==t&&(t=function(t,e){return e}(n,t[0])),null===t&&(P=n),t}function a(){var t;return e.length>P?(t=e.charAt(P),P++):(t=null,0===L&&i("any character")),t}function l(){var t;return/^[a-zA-Z]/.test(e.charAt(P))?(t=e.charAt(P),P++):(t=null,0===L&&i("[a-zA-Z]")),null===t&&(36===e.charCodeAt(P)?(t="$",P++):(t=null,0===L&&i('"$"')),null===t&&(95===e.charCodeAt(P)?(t="_",P++):(t=null,0===L&&i('"_"')))),t}function o(){var t;return t=l(),null===t&&(/^[0-9]/.test(e.charAt(P))?(t=e.charAt(P),P++):(t=null,0===L&&i("[0-9]"))),t}function u(){var t;return L++,/^[\t\x0B\f \xA0\uFEFF]/.test(e.charAt(P))?(t=e.charAt(P),P++):(t=null,0===L&&i("[\\t\\x0B\\f \\xA0\\uFEFF]")),L--,0===L&&null===t&&i("whitespace"),t}function h(){var t;return/^[\n\r\u2028\u2029]/.test(e.charAt(P))?(t=e.charAt(P),P++):(t=null,0===L&&i("[\\n\\r\\u2028\\u2029]")),t}function c(){var t;return L++,10===e.charCodeAt(P)?(t="\n",P++):(t=null,0===L&&i('"\\n"')),null===t&&("\r\n"===e.substr(P,2)?(t="\r\n",P+=2):(t=null,0===L&&i('"\\r\\n"')),null===t&&(13===e.charCodeAt(P)?(t="\r",P++):(t=null,0===L&&i('"\\r"')),null===t&&(8232===e.charCodeAt(P)?(t="\u2028",P++):(t=null,0===L&&i('"\\u2028"')),null===t&&(8233===e.charCodeAt(P)?(t="\u2029",P++):(t=null,0===L&&i('"\\u2029"')))))),L--,0===L&&null===t&&i("end of line"),t}function f(){var t,n,r;return r=P,t=g(),null!==t?(59===e.charCodeAt(P)?(n=";",P++):(n=null,0===L&&i('";"')),null!==n?t=[t,n]:(t=null,P=r)):(t=null,P=r),null===t&&(r=P,t=m(),null!==t?(n=c(),null!==n?t=[t,n]:(t=null,P=r)):(t=null,P=r),null===t&&(r=P,t=g(),null!==t?(n=d(),null!==n?t=[t,n]:(t=null,P=r)):(t=null,P=r))),t}function d(){var t,n;return n=P,L++,e.length>P?(t=e.charAt(P),P++):(t=null,0===L&&i("any character")),L--,null===t?t="":(t=null,P=n),t}function p(){var t;return L++,t=v(),null===t&&(t=_()),L--,0===L&&null===t&&i("comment"),t}function v(){var t,n,r,s,l,o,u;if(l=P,"/*"===e.substr(P,2)?(t="/*",P+=2):(t=null,0===L&&i('"/*"')),null!==t){for(n=[],o=P,u=P,L++,"*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==r;)n.push(r),o=P,u=P,L++,"*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==n?("*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),null!==r?t=[t,n,r]:(t=null,P=l)):(t=null,P=l)}else t=null,P=l;return t}function b(){var t,n,r,s,l,o,u;if(l=P,"/*"===e.substr(P,2)?(t="/*",P+=2):(t=null,0===L&&i('"/*"')),null!==t){for(n=[],o=P,u=P,L++,"*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),null===r&&(r=h()),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==r;)n.push(r),o=P,u=P,L++,"*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),null===r&&(r=h()),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==n?("*/"===e.substr(P,2)?(r="*/",P+=2):(r=null,0===L&&i('"*/"')),null!==r?t=[t,n,r]:(t=null,P=l)):(t=null,P=l)}else t=null,P=l;return t}function _(){var t,n,r,s,l,o,u;if(l=P,"//"===e.substr(P,2)?(t="//",P+=2):(t=null,0===L&&i('"//"')),null!==t){for(n=[],o=P,u=P,L++,r=h(),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==r;)n.push(r),o=P,u=P,L++,r=h(),L--,null===r?r="":(r=null,P=u),null!==r?(s=a(),null!==s?r=[r,s]:(r=null,P=o)):(r=null,P=o);null!==n?(r=h(),null===r&&(r=d()),null!==r?t=[t,n,r]:(t=null,P=l)):(t=null,P=l)}else t=null,P=l;return t}function m(){var t,e;for(t=[],e=u(),null===e&&(e=b(),null===e&&(e=_()));null!==e;)t.push(e),e=u(),null===e&&(e=b(),null===e&&(e=_()));return t}function g(){var t,e;for(t=[],e=u(),null===e&&(e=c(),null===e&&(e=p()));null!==e;)t.push(e),e=u(),null===e&&(e=c(),null===e&&(e=p()));return t}function E(){var t,e;return e=P,t=w(),null===t&&(t=x()),null!==t&&(t=function(t,e){return{type:"NumericLiteral",value:e}}(e,t)),null===t&&(P=e),t}function x(){var t,n,r;if(r=P,/^[0-9]/.test(e.charAt(P))?(n=e.charAt(P),P++):(n=null,0===L&&i("[0-9]")),null!==n)for(t=[];null!==n;)t.push(n),/^[0-9]/.test(e.charAt(P))?(n=e.charAt(P),P++):(n=null,0===L&&i("[0-9]"));else t=null;return null!==t&&(t=function(t,e){return parseInt(e.join(""))}(r,t)),null===t&&(P=r),t}function w(){var t,n,r,s,a;return s=P,a=P,t=x(),null!==t?(46===e.charCodeAt(P)?(n=".",P++):(n=null,0===L&&i('"."')),null!==n?(r=x(),null!==r?t=[t,n,r]:(t=null,P=a)):(t=null,P=a)):(t=null,P=a),null!==t&&(t=function(t,e){return parseFloat(e.join(""))}(s,t)),null===t&&(P=s),t}function y(){var t,n,r,s;if(s=P,/^[\-+]/.test(e.charAt(P))?(t=e.charAt(P),P++):(t=null,0===L&&i("[\\-+]")),t=null!==t?t:"",null!==t){if(/^[0-9]/.test(e.charAt(P))?(r=e.charAt(P),P++):(r=null,0===L&&i("[0-9]")),null!==r)for(n=[];null!==r;)n.push(r),/^[0-9]/.test(e.charAt(P))?(r=e.charAt(P),P++):(r=null,0===L&&i("[0-9]"));else n=null;null!==n?t=[t,n]:(t=null,P=s)}else t=null,P=s;return t}function V(){var t,e;return L++,e=P,t=C(),null!==t&&(t=function(t,e){return e}(e,t)),null===t&&(P=e),L--,0===L&&null===t&&i("identifier"),t}function C(){var t,e,n,r,s;if(L++,r=P,s=P,t=l(),null!==t){for(e=[],n=o();null!==n;)e.push(n),n=o();null!==e?t=[t,e]:(t=null,P=s)}else t=null,P=s;return null!==t&&(t=function(t,e,n){return e+n.join("")}(r,t[0],t[1])),null===t&&(P=r),L--,0===L&&null===t&&i("identifier"),t}function S(){var t,n,r,s,a,l,o;return l=P,t=V(),null!==t&&(t=function(t,e){return{type:"Variable",name:e}}(l,t)),null===t&&(P=l),null===t&&(t=E(),null===t&&(l=P,o=P,40===e.charCodeAt(P)?(t="(",P++):(t=null,0===L&&i('"("')),null!==t?(n=g(),null!==n?(r=N(),null!==r?(s=g(),null!==s?(41===e.charCodeAt(P)?(a=")",P++):(a=null,0===L&&i('")"')),null!==a?t=[t,n,r,s,a]:(t=null,P=o)):(t=null,P=o)):(t=null,P=o)):(t=null,P=o)):(t=null,P=o),null!==t&&(t=function(t,e){return e}(l,t[2])),null===t&&(P=l))),t}function A(){var t,e,n,i,r;return t=S(),null===t&&(i=P,r=P,t=z(),null!==t?(e=g(),null!==e?(n=A(),null!==n?t=[t,e,n]:(t=null,P=r)):(t=null,P=r)):(t=null,P=r),null!==t&&(t=function(t,e,n){return{type:"UnaryExpression",operator:e,expression:n}}(i,t[0],t[2])),null===t&&(P=i)),t}function z(){var t;return 43===e.charCodeAt(P)?(t="+",P++):(t=null,0===L&&i('"+"')),null===t&&(45===e.charCodeAt(P)?(t="-",P++):(t=null,0===L&&i('"-"')),null===t&&(33===e.charCodeAt(P)?(t="!",P++):(t=null,0===L&&i('"!"')))),t}function O(){var t,e,n,i,r,s,a,l,o;if(a=P,l=P,t=A(),null!==t){for(e=[],o=P,n=g(),null!==n?(i=M(),null!==i?(r=g(),null!==r?(s=A(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==n;)e.push(n),o=P,n=g(),null!==n?(i=M(),null!==i?(r=g(),null!==r?(s=A(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==e?t=[t,e]:(t=null,P=l)}else t=null,P=l;return null!==t&&(t=function(t,e,n){for(var i=e,r=0;r<n.length;r++)i={type:"MultiplicativeExpression",operator:n[r][1],left:i,right:n[r][3]};return i}(a,t[0],t[1])),null===t&&(P=a),t}function M(){var t;return 42===e.charCodeAt(P)?(t="*",P++):(t=null,0===L&&i('"*"')),null===t&&(47===e.charCodeAt(P)?(t="/",P++):(t=null,0===L&&i('"/"'))),t}function j(){var t,e,n,i,r,s,a,l,o;if(a=P,l=P,t=O(),null!==t){for(e=[],o=P,n=g(),null!==n?(i=I(),null!==i?(r=g(),null!==r?(s=O(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==n;)e.push(n),o=P,n=g(),null!==n?(i=I(),null!==i?(r=g(),null!==r?(s=O(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==e?t=[t,e]:(t=null,P=l)}else t=null,P=l;return null!==t&&(t=function(t,e,n){for(var i=e,r=0;r<n.length;r++)i={type:"AdditiveExpression",operator:n[r][1],left:i,right:n[r][3]};return i}(a,t[0],t[1])),null===t&&(P=a),t}function I(){var t;return 43===e.charCodeAt(P)?(t="+",P++):(t=null,0===L&&i('"+"')),null===t&&(45===e.charCodeAt(P)?(t="-",P++):(t=null,0===L&&i('"-"'))),t}function R(){var t,e,n,i,r,s,a,l,o;if(a=P,l=P,t=j(),null!==t){for(e=[],o=P,n=g(),null!==n?(i=k(),null!==i?(r=g(),null!==r?(s=j(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==n;)e.push(n),o=P,n=g(),null!==n?(i=k(),null!==i?(r=g(),null!==r?(s=j(),null!==s?n=[n,i,r,s]:(n=null,P=o)):(n=null,P=o)):(n=null,P=o)):(n=null,P=o);null!==e?t=[t,e]:(t=null,P=l)}else t=null,P=l;return null!==t&&(t=function(t,e,n){for(var i=e,r=0;r<n.length;r++)i={type:"Inequality",operator:n[r][1],left:i,right:n[r][3]};return i}(a,t[0],t[1])),null===t&&(P=a),t}function k(){var t;return"<="===e.substr(P,2)?(t="<=",P+=2):(t=null,0===L&&i('"<="')),null===t&&(">="===e.substr(P,2)?(t=">=",P+=2):(t=null,0===L&&i('">="')),null===t&&(60===e.charCodeAt(P)?(t="<",P++):(t=null,0===L&&i('"<"')),null===t&&(62===e.charCodeAt(P)?(t=">",P++):(t=null,0===L&&i('">"'))))),t}function N(){var t,n,r,s,a,l,o,u,h;if(o=P,u=P,t=R(),null!==t){for(n=[],h=P,r=g(),null!==r?("=="===e.substr(P,2)?(s="==",P+=2):(s=null,0===L&&i('"=="')),null!==s?(a=g(),null!==a?(l=R(),null!==l?r=[r,s,a,l]:(r=null,P=h)):(r=null,P=h)):(r=null,P=h)):(r=null,P=h);null!==r;)n.push(r),h=P,r=g(),null!==r?("=="===e.substr(P,2)?(s="==",P+=2):(s=null,0===L&&i('"=="')),null!==s?(a=g(),null!==a?(l=R(),null!==l?r=[r,s,a,l]:(r=null,P=h)):(r=null,P=h)):(r=null,P=h)):(r=null,P=h);null!==n?t=[t,n]:(t=null,P=u)}else t=null,P=u;return null!==t&&(t=function(t,e,n){for(var i=e,r=0;r<n.length;r++)i={type:"Equality",operator:n[r][1],left:i,right:n[r][3]};return i}(o,t[0],t[1])),null===t&&(P=o),t}function T(t){t.sort();for(var e=null,n=[],i=0;i<t.length;i++)t[i]!==e&&(n.push(t[i]),e=t[i]);return n}function q(){for(var t=1,n=1,i=!1,r=0;r<Math.max(P,F);r++){var s=e.charAt(r);"\n"===s?(i||t++,n=1,i=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(t++,n=1,i=!0):(n++,i=!1)}return{line:t,column:n}}var H={start:r,Statement:s,SourceCharacter:a,IdentifierStart:l,IdentifierPart:o,WhiteSpace:u,LineTerminator:h,LineTerminatorSequence:c,EOS:f,EOF:d,Comment:p,MultiLineComment:v,MultiLineCommentNoLineTerminator:b,SingleLineComment:_,_:m,__:g,Literal:E,Integer:x,Real:w,SignedInteger:y,Identifier:V,IdentifierName:C,PrimaryExpression:S,UnaryExpression:A,UnaryOperator:z,MultiplicativeExpression:O,MultiplicativeOperator:M,AdditiveExpression:j,AdditiveOperator:I,InequalityExpression:R,InequalityOperator:k,LinearExpression:N};if(void 0!==n){if(void 0===H[n])throw new Error("Invalid rule name: "+t(n)+".")}else n="start";var P=0,L=0,F=0,D=[],Q=H[n]();if(null===Q||P!==e.length){var J=Math.max(P,F),U=J<e.length?e.charAt(J):null,W=q();throw new this.SyntaxError(T(D),U,J,W.line,W.column)}return Q},toSource:function(){return this._source}};return e.SyntaxError=function(e,n,i,r,s){function a(e,n){var i,r;switch(e.length){case 0:i="end of input";break;case 1:i=e[0];break;default:i=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return r=n?t(n):"end of input","Expected "+i+" but "+r+" found."}this.name="SyntaxError",this.expected=e,this.found=n,this.message=a(e,n),this.offset=i,this.line=r,this.column=s},e.SyntaxError.prototype=Error.prototype,e}(),function(t){"use strict";var e=new t.SimplexSolver,n={},i={},r=t.Strength.weak;t.Strength.medium,t.Strength.strong,t.Strength.required;var s=function(a){if(i[a])return i[a];switch(a.type){case"Inequality":var l="<="==a.operator?t.LEQ:t.GEQ,o=new t.Inequality(s(a.left),l,s(a.right),r);return e.addConstraint(o),o;case"Equality":var o=new t.Equation(s(a.left),s(a.right),r);return e.addConstraint(o),o;case"MultiplicativeExpression":var o=t.times(s(a.left),s(a.right));return e.addConstraint(o),o;case"AdditiveExpression":return"+"==a.operator?t.plus(s(a.left),s(a.right)):t.minus(s(a.left),s(a.right));case"NumericLiteral":return new t.Expression(a.value);case"Variable":return n[a.name]||(n[a.name]=new t.Variable({name:a.name})),n[a.name];case"UnaryExpression":console.log("UnaryExpression...WTF?")}},a=function(t){return t.map(s)};t._api=function(){var n=Array.prototype.slice.call(arguments);if(1==n.length){if("string"==typeof n[0]){var i=t.parser.parse(n[0]);return a(i)}"function"==typeof n[0]&&e._addCallback(n[0])}}}(this.c||module.parent.exports||{})}).call("undefined"!=typeof module?module.compiled=module:this);

},{}],2:[function(require,module,exports){
function Expression(){this._left=null,this._right=null}module.exports=Expression,Expression.prototype.addExpressions=function(t,s){this._left=t,this._right=s},Expression.prototype.construct=function(){};

},{}],3:[function(require,module,exports){
function System(){if(this instanceof System==!1)return new System;this._solver=new cassowary.SimplexSolver,this._solver.autoSolve=!1,this._variables=[],this._constants=[],this._constraints={},this._parameters={},this._onNewSolution=null,this._onNewSolutionParams=null,this._forceResolving=!0,this.z=0,this._objectiveVariable=null,this._optimization=!1,this._minimization=!0;var t=this;this._onParameterMissing=function(i){return t.addVariable(i,{x:0},"x").getVariable(i)}}var cassowary=require("../deps/cassowary.js"),primitives=require("./primitives.js"),operators=require("./operators.js"),parseExpression=require("./parser.js"),Numeral=primitives.Numeral,Constant=primitives.Constant,Variable=primitives.Variable,Equality=operators.Equality,Multiplication=operators.Multiplication;module.exports=System,System.prototype.onNewSolution=function(t,i){return this._onNewSolution=t,this._onNewSolutionParams=i,this},System.prototype._optimize=function(t){t instanceof Variable==!0?(this._objectiveVariable=t,this._solver.optimize(t._variable)):(this._objectiveVariable=new Variable("z",{z:0},"z"),this.addConstraint(new Equality(this._objectiveVariable,t)),this._solver.optimize(this._objectiveVariable._variable)),this._forceResolving=!0,this._optimization=!0},System.prototype.minimize=function(t){return"string"==typeof t&&(t=parseExpression(t,this._parameters,this._onParameterMissing)),this._optimize(t),this._minimization=!0,this},System.prototype.maximize=function(t){return"string"==typeof t&&(t=parseExpression(t,this._parameters,this._onParameterMissing)),this._optimize(new Multiplication(t,new Numeral(-1))),this._minimization=!1,this},System.prototype.addVariable=function(t,i,e){var s=new Variable(t,i,e);return this._variables.push(s),this._parameters[t]=s,this},System.prototype.addConstant=function(t,i,e){var s=new Constant(t,i,e);return this._constants.push(s),this._parameters[t]=s,this},System.prototype.getVariable=function(t){for(var i=0;i<this._variables.length;i+=1)if(this._variables[i]._name===t)return this._variables[i]},System.prototype.addConstraint=function(t){return"string"==typeof t&&(t=parseExpression(t,this._parameters,this._onParameterMissing)),void 0!==this._constraints[t._id]?void console.warn("[System.addConstraint] Constraint already present in the system:",t):(this._solver.addConstraint(t.construct()),this._constraints[t._id]=t,this._forceResolving=!0,this)},System.prototype.removeConstraint=function(t){return void 0===this._constraints[t._id]?void console.warn("[System.removeConstraint] Constraint not present in the system:",t):(t._unregisterFromPrimitives(),this._solver.removeConstraint(t._constraint),delete this._constraints[t._id],this._forceResolving=!0,this)},System.prototype.resolve=function(t){var i,e,s,r=this._forceResolving;this._forceResolving=!1;var o=null;for(i=0;i<this._constants.length;i+=1){var n=this._constants[i];if(n.refresh()){null===o&&(o={});var a=n._constraints;for(e=0;e<a.length;e+=1)s=a[e],o[s.id]=s;r=!0}}if(null!==o){var l=Object.keys(o);for(e=0;e<l.length;e+=1)s=o[l[e]],this._solver.removeConstraint(s._constraint),s.construct(),this._solver.addConstraint(s._constraint)}if(r!==!1||t!==!0){this._solver.resolve();for(var h=!1,_=0;_<this._variables.length;_+=1)this._variables[_].refresh()===!0&&(h=!0);return this._optimization===!0&&(this._objectiveVariable.refresh(),this.z=this._minimization===!0?this._objectiveVariable._value:-this._objectiveVariable._value),h===!0&&null!==this._onNewSolution&&this._onNewSolution(this._onNewSolutionParams),this}},System.prototype.log=function(){for(var t=0;t<this._variables.length;t+=1){var i=this._variables[t];console.log(i._name,"=",i._value)}console.log("objective value =",this.z)},System.prototype.getValue=function(t){return this._parameters[t]._value},System.prototype.getObjectiveValue=function(){return this.z};

},{"../deps/cassowary.js":1,"./operators.js":5,"./parser.js":6,"./primitives.js":7}],4:[function(require,module,exports){
(function (global){
var primitives=require("./primitives.js"),operators=require("./operators.js"),System=require("./System.js"),Numeral=primitives.Numeral,Addition=operators.Addition,Subtraction=operators.Subtraction,Multiplication=operators.Multiplication,Division=operators.Division,GreaterOrEqual=operators.GreaterOrEqual,LowerOrEqual=operators.LowerOrEqual,Equality=operators.Equality,Constrained={System:System,plus:function(e,r){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new Addition(e,r)},minus:function(e,r){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new Subtraction(e,r)},times:function(e,r){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new Multiplication(e,r)},dividedBy:function(e,r){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new Division(e,r)},greaterThan:function(e,r,n,t){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new GreaterOrEqual(e,r,n,t)},lowerThan:function(e,r,n,t){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new LowerOrEqual(e,r,n,t)},equals:function(e,r,n,t){return"number"==typeof e&&(e=new Numeral(e)),"number"==typeof r&&(r=new Numeral(r)),new Equality(e,r,n,t)}},root;"undefined"!=typeof window?root=window:"undefined"!=typeof global?root=global:(console.warn("[TINA] Your environment might not support TINA."),root=this),module.exports=root.Constrained=Constrained;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./System.js":3,"./operators.js":5,"./primitives.js":7}],5:[function(require,module,exports){
function Addition(t,r){Expression.call(this),this.addExpressions(t,r)}function Subtraction(t,r){Expression.call(this),this.addExpressions(t,r)}function Multiplication(t,r){Expression.call(this),this.addExpressions(t,r)}function Division(t,r){Expression.call(this),this.addExpressions(t,r)}function Constraint(t,r,i,o){this._expression1=t,this._expression2=r,this._strength=i,this._weight=o,this._constraint=null,this._id=(constraintCount++).toString(),this._registerToPrimitives()}function LowerOrEqual(t,r,i,o){Constraint.call(this,t,r,i,o)}function GreaterOrEqual(t,r,i,o){Constraint.call(this,t,r,i,o)}function Equality(t,r,i,o){Constraint.call(this,t,r,i,o)}var cassowary=require("../deps/cassowary.js"),Expression=require("./Expression.js");Addition.prototype=Object.create(Expression.prototype),Addition.prototype.constructor=Addition,Addition.prototype.construct=function(){var t=this._left.construct(),r=this._right.construct();return t.plus(r)},Subtraction.prototype=Object.create(Expression.prototype),Subtraction.prototype.constructor=Subtraction,Subtraction.prototype.construct=function(){var t=this._left.construct(),r=this._right.construct();return t.minus(r)},Multiplication.prototype=Object.create(Expression.prototype),Multiplication.prototype.constructor=Multiplication,Multiplication.prototype.construct=function(){var t=this._left.construct(),r=this._right.construct();return t.times(r)},Division.prototype=Object.create(Expression.prototype),Division.prototype.constructor=Division,Division.prototype.construct=function(){var t=this._left.construct(),r=this._right.construct();return t.divide(r)};var constraintCount=0;Constraint.prototype._registerToPrimitives=function(){for(var t=[this._expression1,this._expression2];0!==t.length;){var r=t.pop();null===r._left?r._register(this):(t.push(r._left),t.push(r._right))}},Constraint.prototype._unregisterFromPrimitives=function(){for(var t=[this._expression1,this._expression2];0!==t.length;){var r=t.pop();null===r._left?r._unregister(this):(t.push(r._left),t.push(r._right))}},LowerOrEqual.prototype=Object.create(Constraint.prototype),LowerOrEqual.prototype.constructor=LowerOrEqual,LowerOrEqual.prototype.construct=function(){return this._constraint=new cassowary.Inequality(this._expression1.construct(),cassowary.LEQ,this._expression2.construct(),this._strength,this._weight),this._constraint},GreaterOrEqual.prototype=Object.create(Constraint.prototype),GreaterOrEqual.prototype.constructor=GreaterOrEqual,GreaterOrEqual.prototype.construct=function(){return this._constraint=new cassowary.Inequality(this._expression1.construct(),cassowary.GEQ,this._expression2.construct(),this._strength,this._weight),this._constraint},Equality.prototype=Object.create(Constraint.prototype),Equality.prototype.constructor=Equality,Equality.prototype.construct=function(){return this._constraint=new cassowary.Equation(this._expression1.construct(),this._expression2.construct(),this._strength,this._weight),this._constraint},module.exports={Addition:Addition,Subtraction:Subtraction,Multiplication:Multiplication,Division:Division,LowerOrEqual:LowerOrEqual,GreaterOrEqual:GreaterOrEqual,Equality:Equality};

},{"../deps/cassowary.js":1,"./Expression.js":2}],6:[function(require,module,exports){
function Parser(r){this.str=r,this.parameterMap=null,this.onParameterMissing=null}function parseExpression(r,s,t){var e=new Parser(r);return e.parameterMap=s,e.onParameterMissing=t,e.parseExpression()}var systemOperators=require("./operators.js"),systemPrimitives=require("./primitives.js"),Addition=systemOperators.Addition,Subtraction=systemOperators.Subtraction,Multiplication=systemOperators.Multiplication,Division=systemOperators.Division,GreaterOrEqual=systemOperators.GreaterOrEqual,LowerOrEqual=systemOperators.LowerOrEqual,Equality=systemOperators.Equality,Numeral=systemPrimitives.Numeral;module.exports=parseExpression;var operators=[{id:">=",precedence:2,"class":GreaterOrEqual},{id:"<=",precedence:2,"class":LowerOrEqual},{id:"=",precedence:2,"class":Equality},{id:"+",precedence:3,"class":Addition},{id:"-",precedence:3,"class":Subtraction},{id:"*",precedence:4,"class":Multiplication},{id:"/",precedence:4,"class":Division}],unaryOperators=[],functions=[];Parser.prototype.removeWhiteSpace=function(){var r=this;r.str=r.str.replace(" ",""),r.str=r.str.replace("\n","")},Parser.prototype.parseParenthesis=function(){var r=this;if("("!==r.str[0])throw new Error("An opening parenthesis is missing.");r.str=r.str.substring(1);for(var s="",t=0;")"!==r.str[0]||0!==t;){if("("===r.str[0]&&t++,")"===r.str[0]&&t--,0>t)throw new Error("Too much closing parenthesis.");if(s+=r.str[0],r.str=r.str.substring(1),""===r.str)throw new Error("Parenthesis expression doesn't resolve")}return r.str=r.str.substring(1),s=parseExpression(s,r.parameterMap,r.onParameterMissing)},Parser.prototype.getParenthesisList=function(){var r=this;if("("!==r.str[0])throw new Error("An opening parenthesis is missing.");r.str=r.str.substring(1);for(var s=[],t="",e=0;")"!==r.str[0]||0!==e;){if("("===r.str[0]&&e++,")"===r.str[0]&&e--,0>e)throw new Error("Too much closing parenthesis.");if(","===r.str[0]&&0===e?(t=parseExpression(t),s.push(t),t=""):t+=r.str[0],r.str=r.str.substring(1),""===r.str)throw new Error("Parenthesis expression doesn't resolve")}return t=parseExpression(t),s.push(t),r.str=r.str.substring(1),s},Parser.prototype.parseString=function(){var r=this,s="";if('"'!==r.str[0])throw new Error("An opening quote is missing.");for(r.str=r.str.substring(1);'"'!==r.str[0];)if(s+=r.str[0],r.str=r.str.substring(1),""===r.str)throw new Error("Closing quote not found.");return r.str=r.str.substring(1),{type:"string",value:s}},Parser.prototype.parseNumber=function(){var r=this,s="int",t="";if("-"===r.str[0]&&(t="-",r.str=r.str.substring(1),r.removeWhiteSpace()),""===r.str)throw new Error("End of line before number.");if(-1===r.str[0].search(/[0-9]/))throw new Error("Not a digit character");for(;0===r.str[0].search(/[0-9]/)&&(t+=r.str[0],r.str=r.str.substring(1),""!==r.str););if("."===r.str[0])for(s="float",t+=".",r.str=r.str.substring(1);0===r.str[0].search(/[0-9]/)&&(t+=r.str[0],r.str=r.str.substring(1),""!==r.str););return new Numeral(parseFloat(t))},Parser.prototype.parseFunction=function(r){var s=this,t={type:"function",id:r.id},e=r.parameters;if(0===e)return t;if(Array.isArray(e)&&-1!==e.indexOf(0)&&"("!==s.str[0])return t;var i=s.getParenthesisList(),n=i.length;if(0===n)throw new Error("There is no arguments inside function brackets.");if(!isNaN(e)&&n!==e)throw new Error("Incorrect number of arguments.");if(Array.isArray(e)){for(var a=!1,o=0,u=e.length;u>o;o++)if(n===e[o]){a=!0;break}if(!a)throw new Error("Incorrect number of arguments.")}return t.args=i,t},Parser.prototype.parseVariable=function(){var r=this,s="",t="float";if(-1===r.str[0].search(/[A-Za-z]/))throw new Error("Invalid variable name");for(s+=r.str[0],r.str=r.str.substring(1);""!==r.str&&-1!==r.str[0].search(/[A-Za-z0-9]/);)s+=r.str[0],r.str=r.str.substring(1);if("$"===r.str[0]||"%"===r.str[0]||"!"===r.str[0]){switch(s+=r.str[0],r.str[0]){case"$":t="string";break;case"%":t="int";break;case"!":t="float"}r.str=r.str.substring(1)}var e=r.parameterMap[s];return void 0===e?r.onParameterMissing(s):e},Parser.prototype.getNextObject=function(){var r=this;if(r.removeWhiteSpace(),""===r.str)return null;if("("===r.str[0])return r.parseParenthesis();if('"'===r.str[0])return r.parseString();if("-"===r.str[0]&&-1===r.str[1].search(/[0-9]/))return r.str=r.str.substring(1),new Multiplication(new Numeral(-1),r.getNextObject());var s;for(s=0;s<unaryOperators.length;s++){var t=unaryOperators[s].id,e=t.length;if(r.str.substring(0,e)===t)return r.str=r.str.substring(e),new unaryOperators[s]["class"](r.getNextObject())}if(-1!==r.str[0].search(/[\-0-9]/))return r.parseNumber();for(s=0;s<functions.length;s++){var i=functions[s].id.length;if(r.str.substring(0,i)===functions[s].id)return r.str=r.str.substring(i),r.parseFunction(functions[s])}return-1!==r.str[0].search(/[A-Za-z]/)?r.parseVariable():null},Parser.prototype.getNextOperator=function(){var r=this;if(r.removeWhiteSpace(),""===r.str)return null;for(var s=0;s<operators.length;s++){var t=operators[s].id.length;if(r.str.substring(0,t)===operators[s].id)return r.str=r.str.substring(t),operators[s]}return null},Parser.prototype.parseExpression=function(){for(var r,s=[],t=[];;){if(s.push(this.getNextObject()),r=this.getNextOperator(),null===r)break;t.push(r)}for(var e=0;t.length>0;){r=t[e];var i=t[e+1];if(!i||r.precedence>=i.precedence){var n=new r["class"](s[e],s[e+1]);s.splice(e,2,n),t.splice(e,1),e=0}else e+=1}return s[0]};

},{"./operators.js":5,"./primitives.js":7}],7:[function(require,module,exports){
function Numeral(t){this._value=t,Expression.call(this)}function ObjectBinder(t,e,r){this._name=t,this._object=e,this._property=r,this._value=e[r],this._constraints=[]}function Constant(t,e,r){return this instanceof Constant==!1?new Constant(e,r):(ObjectBinder.call(this,t,e,r),void Expression.call(this))}function Variable(t,e,r){return this instanceof Variable==!1?new Variable(e,r):(this._onChange=null,this._onChangeParams=null,ObjectBinder.call(this,t,e,r),Expression.call(this),void(this._variable=new cassowary.Variable({name:this._name,value:this._value})))}var cassowary=require("../deps/cassowary.js"),Expression=require("./Expression.js");Numeral.prototype=Object.create(Expression.prototype),Numeral.prototype.constructor=Numeral,Numeral.prototype.construct=function(){return new cassowary.Expression(this._value)},Numeral.prototype._register=function(){},Numeral.prototype._unregister=function(){},ObjectBinder.prototype._register=function(t){this._constraints.push(t)},ObjectBinder.prototype._unregister=function(t){var e=this._constraints.indexOf(t);-1===e&&this._constraints.splice(e,1)},Constant.prototype=Object.create(Expression.prototype),Constant.prototype.constructor=Constant,Constant.prototype._register=ObjectBinder.prototype._register,Constant.prototype._unregister=ObjectBinder.prototype._unregister,Constant.prototype.construct=function(){return new cassowary.Expression(this._object[this._property])},Constant.prototype.refresh=function(){return this._value!==this._object[this._property]?(this._value=this._object[this._property],!0):!1},Variable.prototype=Object.create(cassowary.Variable.prototype),Variable.prototype.constructor=Variable,Variable.prototype._register=ObjectBinder.prototype._register,Variable.prototype.construct=function(){return new cassowary.Expression(this._variable,1)},Variable.prototype.refresh=function(){return this._value!==this._variable.value?(this._object[this._property]=this._variable.value,null!==this._onChange&&this._onChange(this._onChangeParams,this._variable.value,this._value),this._value=this._variable.value,!0):!1},Variable.prototype.onChange=function(t,e){return this._onChange=t,this._onChangeParams=e,this},module.exports={Numeral:Numeral,Constant:Constant,Variable:Variable};

},{"../deps/cassowary.js":1,"./Expression.js":2}]},{},[4]);
